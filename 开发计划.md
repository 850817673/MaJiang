# 麻将最优出牌助手 - 开发计划

## 项目概述
- **产品名称**：麻将最优出牌助手
- **技术栈**：uni-app（支持微信小程序 + H5）
- **AI服务**：DeepSeek API

---

## 开发进度

### M1 阶段：基础UI + 手牌输入 + 记牌器 ✅ 已完成

**1. 项目初始化**
- [x] 创建 uni-app 项目结构
- [x] 配置基础样式（麻将牌面样式）
- [x] 创建公共组件目录

**2. 首页（规则选择页）**
- [x] 页面布局
- [x] 规则选项卡片（福州麻将、四川麻将）
- [x] 点击跳转到牌局页面

**3. 牌局页面 - 剩余牌区域（记牌器）**
- [x] 麻将牌组件（MahjongTile）
- [x] 剩余牌展示（按万/条/饼/字分组）
- [x] 点击牌 → 移动到已出牌区 + 数量-1
- [x] 剩余数量为0时置灰

**4. 牌局页面 - 已出牌区域**
- [x] 已出牌列表展示
- [x] 按时间顺序排列
- [x] 撤销功能

**5. 牌局页面 - 手牌区域**
- [x] 手牌展示（13-14张）
- [x] 手动选择手牌功能
- [x] 手牌排序（万/条/饼/字）
- [x] 删除/增加手牌

---

### M2 阶段：AI出牌建议 ✅ 已完成

**1. DeepSeek API 集成**
- [x] API 调用封装（utils/deepseek.js）
- [x] 请求参数构建（规则、手牌、已出牌、剩余牌）
- [x] 响应解析（推荐牌、理由、听牌）

**2. AI分析功能**
- [x] "分析最优出牌"按钮
- [x] 加载状态展示
- [x] 结果展示（推荐牌 + 理由）
- [x] 听牌提示

---

### M3 阶段：福州麻将规则完善

#### ⏳ 待完成

**1. 规则引擎**
- [x] 福州麻将规则配置（基础）
- [ ] 牌型判断逻辑
- [ ] 胡牌判断

**2. 规则适配**
- [x] AI提示词适配福州麻将规则
- [ ] 特殊牌型处理

---

### M4 阶段：多规则扩展

#### ⏳ 待完成
- [x] 四川麻将规则配置（基础）
- [x] 规则切换逻辑
- [ ] UI优化

---

## 已创建文件

```
mj/
├── App.vue                    # 应用入口
├── main.js                    # 主入口
├── index.html                 # H5入口
├── manifest.json              # 应用配置
├── pages.json                 # 页面配置
├── package.json               # 依赖配置
├── vite.config.js             # Vite配置
├── uni.scss                   # 全局样式变量
├── 开发计划.md                 # 本文档
├── pages/
│   ├── index/index.vue        # 首页（规则选择）
│   └── game/game.vue          # 牌局页面
├── components/
│   └── MahjongTile/MahjongTile.vue  # 麻将牌组件
└── utils/
    ├── mahjong.js             # 麻将工具函数
    ├── deepseek.js            # DeepSeek API封装
    └── rules/
        ├── fuzhou.js          # 福州麻将规则
        └── sichuan.js         # 四川麻将规则
```

---

## 配置说明

### DeepSeek API Key
在 `utils/deepseek.js` 中配置你的 API Key：
```javascript
const API_KEY = '你的DeepSeek API Key'
```

---

## 数据结构

### 麻将牌编码
```javascript
// 万：1W-9W
// 条：1T-9T
// 饼：1B-9B
// 字：东E 南S 西X 北N 中Z 发F 白P 
```

### 牌局状态
```javascript
{
  rule: 'fuzhou',           // 当前规则
  handCards: [],            // 手牌
  playedCards: [],          // 已出牌
  leftCards: {},            // 剩余牌数量
}
```

### AI返回结构
```javascript
{
  bestDiscard: '5W',        // 推荐打的牌
  reason: '减少孤张',        // 理由
  ting: ['6W', '9T']        // 听牌（可选）
}
```

---

## 下一步行动
1. 完善规则引擎（胡牌判断等）
2. 优化UI体验
3. 添加更多麻将规则

---

## 运行方式
```bash
# 安装依赖
npm install

# H5开发
npm run dev:h5

# 微信小程序
npm run dev:mp-weixin
```

---

## 更新记录
| 日期 | 更新内容 | 负责人 |
|------|----------|--------|
| 2024-12-09 | 创建开发计划 | AI |
| 2024-12-09 | 完成M1阶段全部功能 | AI |
| 2024-12-09 | 完成M2阶段DeepSeek API接入 | AI |
